<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.cafe24.travelMaker.mapper.PointMapper">
 	<resultMap type="Point" id="pointSelect">
 	
 	</resultMap>
	<insert	id="addPoint" parameterType="SavePoint">
	<selectKey order ="BEFORE" keyProperty="savePointNum" resultType ="String"> 
	 	 SELECT 
			case COUNT(*)
			when 0 then 'save_point_1'
			ELSE CONCAT('save_point_',MAX(CAST(SUBSTRING(save_point_num,12) AS DECIMAL))+1) 
			END AS save_point_num
		FROM
			tb_save_point 
 	</selectKey>
 		INSERT INTO tb_goods
			(g_code, m_id, g_name, g_cate, g_price, g_color, g_size, g_date, g_desc)
		VALUES (#{savePointNum}, #{mId}, #{gName}, #{gCate}, #{gPrice}, #{gColor},#{gSize}, NOW(), #{gDesc})
 	</insert>

</mapper>